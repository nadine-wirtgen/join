<div class="contact-selector">

  <div class="assigned-to-container" (click)="$event.stopPropagation()">

    <!-- Select Box -->
   <div class="assigned-to-select" (click)="toggleDropdown($event)" style="cursor:pointer;">
  <input
    type="text"
    class="contact-search-select"
    placeholder="Select contacts to assign"
    [(ngModel)]="searchTerm"
    (focus)="showDropdown = true"
    (input)="showDropdown = true"
    style="cursor:pointer;"
  />
  <img
    [src]="showDropdown 
      ? 'assets/imgs/add-task/arrow_drop_up.png'
      : 'assets/imgs/add-task/arrow_drop_down.png'"
    class="dropdown-arrow"
    alt="Dropdown Arrow"
  />
</div>

    <!-- Avatar Preview -->
    <div *ngIf="selectedContacts.length > 0" class="avatars-below" (click)="$event.stopPropagation()">
      <div *ngFor="let contact of selectedContacts | slice:0:3" class="avatar" [style.backgroundColor]="getContactColor(contact)">
        {{ getInitials(contact.name) }}
      </div>
      <div *ngIf="selectedContacts.length > 3" class="avatar more">
        +{{ selectedContacts.length - 3 }}
      </div>
    </div>

    <!-- Dropdown -->
    <div *ngIf="showDropdown" class="assigned-to-list" (click)="$event.stopPropagation()">
      <div *ngFor="let contact of filteredContacts" class="single-contact" 
           [class.active]="isContactSelected(contact)" 
           (click)="toggleContact(contact)">
        <div class="avatar-letter-box" [style.backgroundColor]="getContactColor(contact)">
          {{ getInitials(contact.name) }}
        </div>
        <span class="contact-name">{{ contact.name }}</span>
        <img
          [src]="isContactSelected(contact) 
            ? 'assets/imgs/add-task/checkbox_active.png'
            : 'assets/imgs/add-task/checkbox_default.png'"
          class="checkbox-img"
          alt="Checkbox"
        />
      </div>

      <div *ngIf="filteredContacts.length === 0" class="single-contact">
        <span class="contact-name">No contacts found</span>
      </div>
    </div>

  </div>
</div>
